#!/bin/sh


#Get basic system information
run(){
        UPDATED="$(date)"
        HOST="$HOSTNAME"
        CPU="$(uptime | cut -d: -f5)"
	RAM="$(free -m | awk 'NR==2{printf "%s/%sMB", $3,$2}')"
	STORAGE="$(df / -h | awk '$NF=="/"{printf "%s/%s", $3,$2}')"
        UPTIME="$(uptime )"
	OS="$(cat /etc/os-release | grep PRETTY_NAME | cut -d= -f2 | tr -d '"')"
        tjson="$(jq --null-input \
                   --arg updated "$UPDATED" \
                   --arg host "$HOST" \
                   --arg cpu "$CPU" \
                   --arg ram "$RAM" \
                   --arg storage "$STORAGE" \
                   --arg uptime "$UPTIME" \
                   --arg os "$OS" \
                  '{"updated" : $updated,
                    "host": $host,
		    "os": $os,
                    "system": {
                        "cpu": $cpu,
                        "ram": $ram,
                        "storage": $storage,
                        "uptime": $uptime
            }}')"
}
